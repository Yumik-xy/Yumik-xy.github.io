---
layout: post
title: åŸºäºMatlabçš„KNN+PCAè¯­éŸ³äºŒåˆ†ç±»
date: 2021-05-12 23:06:47 +0800
categories: MATLAB
tag: MATLABè¯­éŸ³è¯†åˆ«
---

* content
{:toc}

KNN+PCAå®ç°ç”µåŠ›ç³»ç»Ÿæ­£å¸¸/æ•…éšœäºŒåˆ†ç±»å¤„ç†

<!-- ![]({{ '/styles/article-image/20210512230647_1.jpg' | prepend: site.baseurl }}){:height='80%' width='80%'} -->

### PCAç®€è¦ä»‹ç»

PCAä¹Ÿç§°â€œä¸»å…ƒåˆ†æâ€ï¼Œä¸»è¦ç”¨äºæ•°æ®é™ç»´ï¼Œç±»ä¼¼**æœ€ä¼˜æœ‰æŸå‹ç¼©**æ–¹æ³•

ğŸŒ°ä¾‹å­ï¼š

å¯¹ä¸€ä¸ªäºŒç»´æ•°æ®ï¼Œæ‰¾åˆ°ä¸€æ¡ç›´çº¿ä½¿æ‰€æœ‰æ•°æ®è·ç¦»çº¿çš„è·ç¦»ä¹‹å’Œæœ€çŸ­ï¼Œè¯¥çº¿ç§°ä¸º**æœ€ä½³æŠ•å½±çº¿**ï¼Œæ­¤æ—¶è¯¥ç‚¹åˆ°åŸç‚¹è¿æˆçš„çº¿æ®µåœ¨çº¿ä¸ŠæŠ•å½±çš„è·ç¦»â€œæœ€é•¿â€ï¼ˆå³åˆ°åŸç‚¹çš„è·ç¦»ä¸€å®šï¼Œåˆ°ç›´çº¿è·ç¦»æœ€çŸ­ï¼Œå› æ­¤åœ¨ç›´çº¿ä¸Šçš„æŠ•å½±æœ€é•¿ï¼‰ï¼Œå³å¯ä»¥ä¿ç•™æœ€å¤šçš„æœ‰æ•ˆä¿¡æ¯ã€‚

<img src="https://raw.githubusercontent.com/Yumik-xy/blogImage/main/img/20210512233141.png" alt="image-20210512233141030" style="zoom:67%;" />

### KNNç®€è¦ä»‹ç»

KNNç§°â€œKé‚»è¿‘ç®—æ³•â€ï¼Œä¸»è¦ç”¨äºåˆ¤æ®æ•°æ®å±äºå“ªä¸€åˆ†ç±»

ğŸŒ°ä¾‹å­ï¼š

 å¯¹äºä¸€ç»„æ•°æ®ï¼Œç°å°†å…¶åˆ†æˆAã€Bä¸¤ç»„ã€‚ç°åœ¨æœ‰ä¸€æœªçŸ¥èŠ‚ç‚¹ï¼Œä¸ºå¯»æ‰¾å…¶ç»„åˆ«ï¼Œç®—æ³•ä¼šå¯»æ—©å…¶è·ç¦»æœ€è¿‘çš„Kä¸ªèŠ‚ç‚¹ï¼Œè‹¥KèŠ‚ç‚¹ä¸­Aç»„èŠ‚ç‚¹æ•°>Bç»„èŠ‚ç‚¹æ•°ï¼Œåˆ™èŠ‚ç‚¹å½’ä¸ºAç»„ï¼Œåä¹‹åŒç†ã€‚

<img src="https://raw.githubusercontent.com/Yumik-xy/blogImage/main/img/20210512233808.png" alt="image-20210512233808658" style="zoom:67%;" />

### è¯†åˆ«è¿‡ç¨‹

#### è¯»å…¥è®­ç»ƒé›†æ•°æ®å’Œè®­ç»ƒé›†æ ‡ç­¾

è¯»å–è®­ç»ƒç›®å½•æ‰€æœ‰çš„å£°éŸ³æ•°æ®å’Œæ ‡ç­¾ï¼Œç”±äºæä¾›çš„æ ‡ç­¾ä¸º$[1,2]$åˆ†å¸ƒçš„å€¼ï¼Œæ•…è¿™é‡Œå°†å…¶è½¬åŒ–ä¸º$[-1,1]$åˆ†å¸ƒä¾¿äºè¿›è¡ŒäºŒåˆ†ç±»åˆ¤å†³

```matlab
train_wav_path_list = dir(strcat(train_path,'*.wav')); % è¯»å–æ‰€æœ‰ wav æ–‡ä»¶
train_wav_length = length(train_wav_path_list); % å¤„ç†è®­ç»ƒé›†æ•°æ®
train_selection_wav = zeros(train_wav_length,171); % è®­ç»ƒé›†ä¿å­˜
train_lable = [1 1 ... 2 2 2 ... 1];
train_lable = (train_lable - 1.5)*2;
```

#### è®­ç»ƒé›†æ•°æ®è¿›è¡Œé¢„å¤„ç†

å¯¹æ‰€æœ‰çš„æ•°æ®è¿›è¡Œç‰¹å¾å€¼é€‰æ‹©ï¼Œå¹¶ä¿å­˜åœ¨é€‰æ‹©åçš„çŸ©é˜µä¸­ã€‚

```matlab
for i = 1:train_wav_length
    wav = audioread([train_path, num2str(i), '.wav'])'; % è¯»å…¥æ•°æ®
    wav = wav(1:max_audio);
    selection_wav = feature_selection(wav); % ç‰¹å¾é€‰æ‹©å‡½æ•°
    selection_wav = selection_wav'; % è½¬ç½®
    train_selection_wav(i,:) = selection_wav(:);
end
```

æ³¨æ„åˆ°å‡½æ•°`feature_selection(wav)`å³ä¸ºç‰¹å¾å€¼é€‰æ‹©å‡½æ•°ã€‚

å‡½æ•°é¦–å…ˆå¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œå½’ä¸€åŒ–æ“ä½œï¼Œå°†æ•°æ®è¿›è¡Œ0ç‚¹å¯¹é½ä½¿å¾—æ‰€æœ‰æ•°æ®å’Œä¸º0ï¼Œè¿™æ ·æ˜¯ä¸ºäº†æ›´å¥½çš„åšPCAè¿ç®—ï¼Œå½’ä¸€åŒ–å…¬å¼ä¸º
$$
x^*=\frac{x-\mu}{\sigma}
$$
å‡½æ•°å¦‚ä¸‹ï¼š

```matlab
function new_data = normalization(data) % æ•°æ®å½’ä¸€åŒ–å‡½æ•°
    data_mean = mean(data); % æ±‚å‡å€¼Î¼
    data_norm = norm(data);
    new_data = (data - data_mean) / data_norm;
end
```

è¿›è¡Œå½’ä¸€åŒ–åå°†8000bitè¯­éŸ³ä¿¡å·è¿›è¡Œåˆ†å¸§ï¼Œåˆ†å¸§æ•°é€šè¿‡å…¬å¼
$$
fn=\frac{N-wlen}{inc}/+1
$$
è¿›è¡Œè®¡ç®—ã€‚å–åˆ†å¸§é•¿åº¦ä¸º800å¸§ï¼Œå¸§ç§»ä¸º400ï¼Œè®¡ç®—å¯å¾—éœ€è¦åˆ†æˆ19å¸§ï¼Œå¸§ä¸å¸§ä¹‹é—´é€šè¿‡Hammingç è¿›è¡Œè¿æ¥ï¼Œåˆ†å¸§å‡½æ•°å¦‚ä¸‹ï¼š

```matlab
function f=enframe(data,win,inc)
    nx=length(data);
    nwin=length(win);
    if (nwin == 1)
       len = win;
    else
       len = nwin;
    end
    if (nargin < 3)
       inc = len;
    end
    nf = fix((nx-len+inc)/inc);
    f=zeros(nf,len);
    indf= inc*(0:(nf-1)).';
    inds = (1:len);
    f(:) = data(indf(:,ones(1,len))+inds(ones(nf,1),:));
    if (nwin > 1)
        w = win(:)';
        f = f .* w(ones(nf,1),:);
    end
end
```

åˆ†å¸§åçš„å³å¯¹æ¯ä¸€å¸§è¿›è¡Œç‰¹å¾å€¼é€‰æ‹©ã€‚å¯¹åˆ†å¸§åæ•°æ®è¿›è¡Œå‚…é‡Œå¶å˜æ¢ï¼Œè®¡ç®—å¾—åˆ°å­å¸¦èƒ½é‡å’Œæ€»çš„é¢‘å¸¦èƒ½é‡ä½œä¸ºè¯¥å¸§çš„ç‰¹å¾å€¼ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°$9\times19$çš„ç‰¹å¾å€¼çŸ©é˜µï¼Œç‰¹å¾å€¼é€‰æ‹©å‡½æ•°å¦‚ä¸‹ï¼š

```matlab
function selection_data = feature_selection(data) % ç‰¹å¾é€‰æ‹©å‡½æ•°
    enframe_data = enframe(data,hamming(800),400); % å£°éŸ³åˆ†æˆ19å¸§ä¿¡å·
    E = [];
    for i = 1:size(enframe_data,1)
        wav_std = normalization(enframe_data(i,:)); % æ•°æ®å½’ä¸€åŒ–
        wav_std_fft = abs(fft(wav_std,2048)); % åš2048çš„fftå˜æ¢
        % è®¡ç®—é¢‘å¸¦èƒ½é‡
        E0 = sum(wav_std_fft(1:1024).^2); % æ€»èƒ½é‡
        E1 = sum(wav_std_fft(1:120).^2); % å­å¸¦èƒ½é‡
        E2 = sum(wav_std_fft(121:250).^2); % å­å¸¦èƒ½é‡
        E3 = sum(wav_std_fft(251:360).^2); % å­å¸¦èƒ½é‡
        E4 = sum(wav_std_fft(361:480).^2); % å­å¸¦èƒ½é‡
        E5 = sum(wav_std_fft(481:600).^2); % å­å¸¦èƒ½é‡
        E6 = sum(wav_std_fft(601:730).^2); % å­å¸¦èƒ½é‡
        E7 = sum(wav_std_fft(731:850).^2); % å­å¸¦èƒ½é‡
        E8 = sum(wav_std_fft(851:1024).^2); % å­å¸¦èƒ½é‡    
        E = [E; E0 E1 E2 E3 E4 E5 E6 E7 E8];
    end
    selection_data = E;
end
```

#### è¯»å…¥æµ‹è¯•é›†æ•°æ®å’Œæµ‹è¯•é›†æ ‡ç­¾

æµ‹è¯•é›†çš„å¤„ç†æ–¹å¼ä¸è®­ç»ƒé›†å®Œå…¨ä¸€è‡´ï¼Œè¿™é‡Œä¸å†è¿‡å¤šèµ˜è¿°ã€‚è‹¥è®­ç»ƒé›†è¾ƒå¤§ï¼Œå¯ä»¥å°†è®­ç»ƒå¾—åˆ°çš„ç‰¹å¾å€¼å˜é‡å†™å…¥ä¸º*.mat*æ–‡ä»¶è¿›è¡Œä¿å­˜ï¼Œæ–¹ä¾¿åæœŸè°ƒç”¨ã€‚

#### è¿›è¡ŒKNNé‚»è¿‘ç®—æ³•ï¼Œæ±‚è§£æµ‹è¯•é›†åˆ†ç±»



#### è®¡ç®—æµ‹è¯•é›†å’Œè®­ç»ƒé›†äºŒè€…2l-èŒƒæ•°è·ç¦»

#### å–æœ€å°çš„kä¸ªå€¼ï¼Œåˆ¤æ–­æ­£å¸¸/å¼‚å¸¸ç»„

#### è®¡ç®—é”™è¯¯ç‡

